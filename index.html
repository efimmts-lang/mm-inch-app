
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MM ↔ INCH</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #111;
      color: white;
      text-align: center;
      padding: 30px;
    }
    input {
      padding: 10px;
      font-size: 18px;
      width: 85%;
      max-width: 420px;
      margin: 10px;
      border-radius: 10px;
      border: 1px solid #333;
      background: #0d0d0d;
      color: #fff;
    }
    button {
      padding: 10px 20px;
      font-size: 18px;
      margin: 10px;
      cursor: pointer;
      border-radius: 10px;
      border: 1px solid #333;
      background: #1b1b1b;
      color: #fff;
    }
    .result {
      margin-top: 18px;
      font-size: 20px;
      white-space: pre-line;
      line-height: 1.35;
    }
    .hint {
      opacity: 0.75;
      font-size: 14px;
      margin-top: 8px;
    }
  </style>
</head>
<body>

  <h2>MM ↔ INCH Converter</h2>

  <input id="value" placeholder='Examples: 25.4  |  1-3/8  |  3/8  |  1.25  |  2"' />
  <br />
  <button onclick="autoConvert()">Convert</button>

  <div class="result" id="result"></div>
  <div class="hint">Auto: type value → result updates. Enter also works.</div>

  <script>
    const INCH_IN_MM = 25.4;
    const DENOM_MAX = 64; // up to 1/64

    function setResult(txt) {
      document.getElementById("result").innerText = txt;
    }

    function gcd(a, b) {
      a = Math.abs(a);
      b = Math.abs(b);
      while (b) {
        const t = a % b;
        a = b;
        b = t;
      }
      return a || 1;
    }

    function toMixedFraction(x, denomMax = DENOM_MAX) {
      if (!isFinite(x)) return "";
      const sign = x < 0 ? "-" : "";
      x = Math.abs(x);

      const whole = Math.floor(x + 1e-12);
      const frac = x - whole;

      if (frac < 1e-12) return `${sign}${whole}"`;

      // find best numerator/denominator up to denomMax
      let bestNum = 0, bestDen = 1, bestErr = Infinity;

      for (let den = 2; den <= denomMax; den++) {
        const num = Math.round(frac * den);
        const err = Math.abs(frac - (num / den));
        if (err < bestErr) {
          bestErr = err;
          bestNum = num;
          bestDen = den;
        }
      }

      // reduce
      const g = gcd(bestNum, bestDen);
      bestNum = Math.floor(bestNum / g);
      bestDen = Math.floor(bestDen / g);

      // carry if equals 1
      let w = whole;
      if (bestNum === bestDen) { w += 1; bestNum = 0; bestDen = 1; }

      if (bestNum === 0) return `${sign}${w}"`;
      if (w === 0) return `${sign}${bestNum}/${bestDen}"`;
      return `${sign}${w}-${bestNum}/${bestDen}"`;
    }

    function parseInchInput(raw) {
      // accepts: 1-3/8, 1 3/8, 3/8, 1.25, 2"
      if (!raw) return NaN;
      let s = raw.trim().toLowerCase();

      // remove inch marks
      s = s.replace(/inches|inch|in/g, "");
      s = s.replace(/"/g, "").trim();

      // normalize: "1 3/8" -> "1-3/8"
      s = s.replace(/\s+/g, " ");
      if (/^\d+\s+\d+\/\d+$/.test(s)) {
        s = s.replace(" ", "-");
      }

      // decimal
      if (/^[+-]?\d+(\.\d+)?$/.test(s)) {
        return parseFloat(s);
      }

      // fraction only: 3/8
      if (/^[+-]?\d+\/\d+$/.test(s)) {
        const neg = s.startsWith("-");
        if (neg) s = s.slice(1);
        const [a, b] = s.split("/").map(Number);
        if (!b) return NaN;
        const v = a / b;
        return neg ? -v : v;
      }

      // mixed: 1-3/8
      if (/^[+-]?\d+\-\d+\/\d+$/.test(s)) {
        const neg = s.startsWith("-");
        if (neg) s = s.slice(1);
        const [wPart, fPart] = s.split("-");
        const w = Number(wPart);
        const [a, b] = fPart.split("/").map(Number);
        if (!b) return NaN;
        const v = w + (a / b);
        return neg ? -v : v;
      }

      return NaN;
    }

    function isLikelyMm(raw) {
      // if contains fraction symbols or inch marks -> inches
      if (/[\/"-]/.test(raw)) return false;
      if (/\d+\s+\d+\/\d+/.test(raw)) return false;
      return true;
    }

    function autoConvert() {
      const raw = document.getElementById("value").value.trim();
      if (!raw) { setResult(""); return; }

      if (isLikelyMm(raw)) {
        const mm = parseFloat(raw);
        if (isNaN(mm)) {
          setResult('Enter mm like: 25.4\nor inches like: 1-3/8, 3/8, 1.25, 2"');
          return;
        }
        const inch = mm / INCH_IN_MM;
        const frac = toMixedFraction(inch);
        setResult(
          `${mm} mm = ${inch.toFixed(5)} inch\n≈ ${frac} (up to 1/64)`
        );
      } else {
        const inch = parseInchInput(raw);
        if (isNaN(inch)) {
          setResult('Enter inches like: 1-3/8, 1 3/8, 3/8, 1.25, 2"');
          return;
        }
        const mm = inch * INCH_IN_MM;
        setResult(`${raw} inch = ${mm.toFixed(3)} mm`);
      }
    }

    window.addEventListener("DOMContentLoaded", () => {
      const inp = document.getElementById("value");
      inp.addEventListener("input", autoConvert);
      inp.addEventListener("keydown", (e) => {
        if (e.key === "Enter") autoConvert();
      });
    });
  </script>

</body>
</html>
