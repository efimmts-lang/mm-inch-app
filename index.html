<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MM ↔ INCH Pro</title>

<style>
body {
  font-family: Arial;
  background: #111;
  color: white;
  text-align: center;
  padding: 30px;
}

input {
  padding: 10px;
  font-size: 18px;
  width: 85%;
  max-width: 400px;
  margin: 10px;
  border-radius: 8px;
  border: 1px solid #333;
  background: #0d0d0d;
  color: white;
}

button {
  padding: 8px 18px;
  font-size: 16px;
  margin: 5px;
  cursor: pointer;
  border-radius: 8px;
  border: 1px solid #333;
  background: #1b1b1b;
  color: white;
}

button.active {
  background: #2e7d32;
}

.result {
  margin-top: 20px;
  font-size: 20px;
  white-space: pre-line;
}
</style>
</head>

<body>

<h2>MM ↔ INCH Converter (Pro)</h2>

<div>
  <button id="mmBtn" class="active" onclick="setMode('mm')">MM input</button>
  <button id="inchBtn" onclick="setMode('inch')">INCH input</button>
</div>

<input id="value" placeholder="Enter value">
<br>

<button onclick="convert()">Convert</button>

<div class="result" id="result"></div>

<script>

const INCH_IN_MM = 25.4;
const DENOM_MAX = 64;
let mode = "mm";

function setMode(m){
  mode = m;
  document.getElementById("mmBtn").classList.remove("active");
  document.getElementById("inchBtn").classList.remove("active");
  document.getElementById(m+"Btn").classList.add("active");
  document.getElementById("result").innerText = "";
}

function gcd(a,b){
  a=Math.abs(a); 
  b=Math.abs(b);
  while(b){ [a,b]=[b,a%b]; }
  return a||1;
}

function toMixedFraction(x){
  const sign = x < 0 ? "-" : "";
  x = Math.abs(x);

  const whole = Math.floor(x);
  const frac = x - whole;

  if (frac < 1e-12) return `${sign}${whole}"`;

  let bestNum=0,bestDen=1,bestErr=Infinity;

  for(let den=2;den<=DENOM_MAX;den++){
    const num=Math.round(frac*den);
    const err=Math.abs(frac-(num/den));
    if(err<bestErr){
      bestErr=err;
      bestNum=num;
      bestDen=den;
    }
  }

  const g=gcd(bestNum,bestDen);
  bestNum/=g;
  bestDen/=g;

  if(bestNum===bestDen){
    return `${sign}${whole+1}"`;
  }

  if(whole===0){
    return `${sign}${bestNum}/${bestDen}"`;
  }

  return `${sign}${whole}-${bestNum}/${bestDen}"`;
}

function parseInchInput(s){
  if(!s) return NaN;
  s=s.replace(/"/g,"").trim();

  if(/^[+-]?\d+(\.\d+)?$/.test(s)){
    return parseFloat(s);
  }

  if(/^[+-]?\d+\/\d+$/.test(s)){
    const neg=s.startsWith("-");
    if(neg) s=s.slice(1);
    const[a,b]=s.split("/").map(Number);
    if(!b) return NaN;
    return neg?-(a/b):(a/b);
  }

  if(/^[+-]?\d+\-\d+\/\d+$/.test(s)){
    const neg=s.startsWith("-");
    if(neg) s=s.slice(1);
    const[w,f]=s.split("-");
    const[a,b]=f.split("/").map(Number);
    if(!b) return NaN;
    const val=Number(w)+(a/b);
    return neg?-val:val;
  }

  return NaN;
}

function convert(){
  const raw=document.getElementById("value").value.trim();
  if(!raw) return;

  if(mode==="mm"){
    const mm=parseFloat(raw);
    if(isNaN(mm)){
      document.getElementById("result").innerText="Enter numeric mm value";
      return;
    }
    const inch=mm/INCH_IN_MM;
    const frac=toMixedFraction(inch);
    document.getElementById("result").innerText=
      `${mm} mm = ${inch.toFixed(5)} inch\n≈ ${frac}`;
  }
  else{
    const inch=parseInchInput(raw);
    if(isNaN(inch)){
      document.getElementById("result").innerText=
        'Enter inch like: 1.375  or  3/8  or  1-3/8';
      return;
    }
    const mm=inch*INCH_IN_MM;
    document.getElementById("result").innerText=
      `${raw} inch = ${mm.toFixed(3)} mm`;
  }
}

document.getElementById("value")
  .addEventListener("keydown",e=>{
    if(e.key==="Enter") convert();
  });

</script>

</body>
</html>
